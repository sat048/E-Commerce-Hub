import React, { useEffect, useState } from 'react';
import BulletScreen, { StyledBullet } from 'rc-bullets';
import { Carousel, WingBlank } from 'antd-mobile';
const headUrl = ['https://zerosoul.github.io/rc-bullets/assets/img/heads/girl.jpg', 'https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fc-ssl.duitang.com%2Fuploads%2Fitem%2F201909%2F13%2F20190913075816_nKUFu.thumb.400_0.jpeg&refer=http%3A%2F%2Fc-ssl.duitang.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=jpeg?sec=1628165068&t=e8d3e432adc252e1a58b8b55d65a89b5', 'https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fpic.jj20.com%2Fup%2Fallimg%2F1114%2F0H120155P2%2F200H1155P2-8-1200.jpg&refer=http%3A%2F%2Fpic.jj20.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=jpeg?sec=1628165421&t=29b2af8b6ebef96ddc4ec843e6be9c56', 'https://gimg2.baidu.com/image_search/src=http%3A%2F%2F01.minipic.eastday.com%2F20161220%2F20161220173435_a82785b45e43e0502379fa14133673c9_5.jpeg&refer=http%3A%2F%2F01.minipic.eastday.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=jpeg?sec=1628166773&t=7d0ae2c96128e074c63305bac938871f', 'https://pics4.baidu.com/feed/8b13632762d0f7038d3025488f46543a2497c5e3.jpeg?token=31514bf6b20f2d7f43e1a36b0575a247', 'https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fimg5.51tietu.net%2Fpic%2F2019-081223%2Fyez4yr4piqxyez4yr4piqx.jpg&refer=http%3A%2F%2Fimg5.51tietu.net&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=jpeg?sec=1628166773&t=d647a8e042c561b19eec6e3cbc1dad9c', 'https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fnimg.ws.126.net%2F%3Furl%3Dhttp%253A%252F%252Fdingyue.ws.126.net%252F2021%252F0529%252F1f444cf5j00qtuzv50010c000hs00nbm.jpg%26thumbnail%3D650x2147483647%26quality%3D80%26type%3Djpg&refer=http%3A%2F%2Fnimg.ws.126.net&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=jpeg?sec=1628166773&t=a8f8e42e94ddcc191eaf13bad895eddb', 'https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fimg01.jituwang.com%2F170608%2F256907-1F60Q0550098.jpg&refer=http%3A%2F%2Fimg01.jituwang.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=jpeg?sec=1628166808&t=69c379d3703098f12001bd98929a17b1', 'https://gimg2.baidu.com/image_search/src=http%3A%2F%2F222.186.12.239%3A10010%2Fguganm_20190222%2F003.jpg&refer=http%3A%2F%2F222.186.12.239&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=jpeg?sec=1628166808&t=8195ffb7b354eeb8606e9da1f2b5fba1', 'https://gimg2.baidu.com/image_search/src=http%3A%2F%2F00.minipic.eastday.com%2F20170114%2F20170114132417_5d20a3d7713e7fb601c4775733a6b708_9.jpeg&refer=http%3A%2F%2F00.minipic.eastday.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=jpeg?sec=1628166808&t=71440f53bfc7586d8c0985a1225a3921'];


export default function My() {
    // 弹幕屏幕
    const [screen, setScreen] = useState(null);
    // 弹幕内容
    const [bullet, setBullet] = useState('');
    let [data, setData] = useState(["1", "2", "3"]);
    // let [imgHeight] = useState(176);
    // let [slideIndex, setSindex] = useState(0)
    useEffect(() => {
        // 给页面中某个元素初始化弹幕屏幕，一般为一个大区块。此处的配置项全局生效
        let s = new BulletScreen('.screen', { duration: 5 });
        // or
        // let s=new BulletScreen(document.querySelector('.screen));
        setScreen(s);


        setTimeout(() => {

            setData(['https://zerosoul.github.io/rc-bullets/assets/img/heads/girl.jpg', 'https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fc-ssl.duitang.com%2Fuploads%2Fitem%2F201909%2F13%2F20190913075816_nKUFu.thumb.400_0.jpeg&refer=http%3A%2F%2Fc-ssl.duitang.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=jpeg?sec=1628165068&t=e8d3e432adc252e1a58b8b55d65a89b5', 'https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fpic.jj20.com%2Fup%2Fallimg%2F1114%2F0H120155P2%2F200H1155P2-8-1200.jpg&refer=http%3A%2F%2Fpic.jj20.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=jpeg?sec=1628165421&t=29b2af8b6ebef96ddc4ec843e6be9c56', 'https://gimg2.baidu.com/image_search/src=http%3A%2F%2F01.minipic.eastday.com%2F20161220%2F20161220173435_a82785b45e43e0502379fa14133673c9_5.jpeg&refer=http%3A%2F%2F01.minipic.eastday.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=jpeg?sec=1628166773&t=7d0ae2c96128e074c63305bac938871f', 'https://pics4.baidu.com/feed/8b13632762d0f7038d3025488f46543a2497c5e3.jpeg?token=31514bf6b20f2d7f43e1a36b0575a247', 'https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fimg5.51tietu.net%2Fpic%2F2019-081223%2Fyez4yr4piqxyez4yr4piqx.jpg&refer=http%3A%2F%2Fimg5.51tietu.net&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=jpeg?sec=1628166773&t=d647a8e042c561b19eec6e3cbc1dad9c', 'https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fnimg.ws.126.net%2F%3Furl%3Dhttp%253A%252F%252Fdingyue.ws.126.net%252F2021%252F0529%252F1f444cf5j00qtuzv50010c000hs00nbm.jpg%26thumbnail%3D650x2147483647%26quality%3D80%26type%3Djpg&refer=http%3A%2F%2Fnimg.ws.126.net&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=jpeg?sec=1628166773&t=a8f8e42e94ddcc191eaf13bad895eddb', 'https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fimg01.jituwang.com%2F170608%2F256907-1F60Q0550098.jpg&refer=http%3A%2F%2Fimg01.jituwang.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=jpeg?sec=1628166808&t=69c379d3703098f12001bd98929a17b1', 'https://gimg2.baidu.com/image_search/src=http%3A%2F%2F222.186.12.239%3A10010%2Fguganm_20190222%2F003.jpg&refer=http%3A%2F%2F222.186.12.239&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=jpeg?sec=1628166808&t=8195ffb7b354eeb8606e9da1f2b5fba1', 'https://gimg2.baidu.com/image_search/src=http%3A%2F%2F00.minipic.eastday.com%2F20170114%2F20170114132417_5d20a3d7713e7fb601c4775733a6b708_9.jpeg&refer=http%3A%2F%2F00.minipic.eastday.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=jpeg?sec=1628166808&t=71440f53bfc7586d8c0985a1225a3921'])

        }, 100);

    }, []);
    // 弹幕内容输入事件处理
    const handleChange = ({ target: { value } }) => {
        setBullet(value);
    };
    // 发送弹幕
    const handleSend = () => {
        if (bullet) {

            screen.push(
                <StyledBullet
                    head={headUrl[Math.floor(Math.random() * headUrl.length)]}
                    msg={bullet}
                    backgroundColor={'#fff'}
                    size='large'
                />
            );
        }
    };
    return (
        <div className="my">
            <div className="up">
                <div className="screen" style={{ width: '100vw', height: '65vw' }}></div>
                <div className="send"> <input value={bullet} onChange={handleChange} />
                    <button onClick={handleSend}>发送</button></div>
            </div>
            <div className="down">
                <WingBlank>
                    <Carousel className="space-carousel"
                        frameOverflow="visible" c
                        cellSpacing={10}
                        slideWidth={0.8}
                        autoplay
                        infinite
                        // beforeChange={(from, to) => console.log(`slide from ${from} to ${to}`)}
                        // afterChange={index =>
                        //     // this.setState({ slideIndex: index })}
                        //     setSindex(index)}
                    >
                        {data.map((val, index) => (
                            // <a
                            //     key={val}
                            //     href="http://www.alipay.com"
                            //     style={{
                            //         display: 'block',
                            //         position: 'relative',
                            //         top: slideIndex === index ? -10 : 0,
                            //         height: imgHeight,
                            //         boxShadow: '2px 1px 1px rgba(0, 0, 0, 0.2)',
                            //     }}
                            // >
                                <img
                                // {`https://zos.alipayobjects.com/rmsportal/${val}.png`}
                                    src={val}
                                    alt=""
                                    style={{ width: '100%', verticalAlign: 'top' }}
                                    onLoad={() => {
                                        // fire window resize event to change height
                                        window.dispatchEvent(new Event('resize'));
                                        // this.setState({ imgHeight: 'auto' });
                                    }}
                                />
                            // </a>
                        ))}
                    </Carousel>
                </WingBlank>
            </div>
        </div>
    )
}
